--- layout: default ---

<div id="main">
	<article>
		<header class="major">
			<h2 class="post-title"><a href="/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/">Interpretare HTML in una stringa popolata da angular con ng-bind-html</a></h2>
			<p class="post-meta">May 17, 2015 ‚Ä¢ musikele</p>
		</header>

		<section>

			<p>Lo sapevate che non potevate inserire del testo html all‚Äôinterno di una variabile _bind_ata con angular? Eh? Eh? Lo sapevate?</p>

<p>Facciamo l‚Äôesempio: in un controller dichiariamo una variabile cos√¨:</p>

<pre class="lang:default decode:true ">$scope.errorMessage = 'this is not good! &lt;br&gt; it won't work!'</pre>

<p>e nell‚ÄôHTML, a un certo punto, vogliamo mostrare questo messaggio in un div:</p>

<pre class="lang:default decode:true ">&lt;div ng-controller="..."&gt;&lt;/div&gt;</pre>

<p>il <br /> sar√† interpretato come ‚Äúa capo‚Äù? o vedremo scritto proprio <span class="lang:default decode:true  crayon-inline "><br /></span>¬†?</p>

<p>‚Ä¶.Vedremo scritto proprio <span class="lang:default decode:true  crayon-inline "><br /></span>¬†. Motivo per cui ci sono io a spiegarvi perch√® e come aggirare il problema üôÇ</p>

<p>Pochi sanno che quando scriviamo <span class="lang:default decode:true  crayon-inline ">&lt;p&gt;&lt;/p&gt;</span>¬† in realt√† per Angular stiamo scrivendo <span class="lang:default decode:true  crayon-inline">&lt;p ng-bind="variabile"&gt;&lt;/p&gt;</span>; insomma il famosissimo <em>two way binding</em> di Angular √® una direttiva bella e buona! I creatori di Angular hanno pensato che √® decisamente pi√π chiaro scrivere con le parentesi graffe, in modo che anche un non-programmatore possa capire il contenuto dell‚Äôhtml. Angular stesso poi tradurr√† le <span class="lang:default decode:true  crayon-inline ">{{‚Ä¶}}  </span>¬† in <span class="lang:default decode:true  crayon-inline ">ng-bind=‚Äù‚Ä¶‚Äù</span>¬† , e infine la variabile in testo.</p>

<h3 id="un-buon-motivo-per-usare-ng-bind">Un buon motivo per usare ng-bind</h3>

<p>Solitamente non dovreste rinunciare alla potenza espressiva delle <code class="highlighter-rouge"><span class="p">{</span><span class="err">{...</span><span class="p">}</span><span class="err">}</span></code>¬†, per√≤ c‚Äô√® un caso speciale che magari <code class="highlighter-rouge">ng-bind</code> pu√≤ essere d‚Äôaiuto: al caricamento della prima pagina della nostra webapp.</p>

<p>Quando apriamo la nostra bellissima webapp per la prima volta, il browser inizia a caricare subito il DOM, e poi inizia a scaricare e a eseguire i file javascript. Questo significa che, finch√® non verr√† scaricato il js di Angular, per pochi istanti vedremo le antipaticissime parentesi graffe.</p>

<p>La soluzione a questo problema √® data proprio da <a href="https://docs.angularjs.org/api/ng/directive/ngBind">ng-bind</a>, ossia finch√® Angular non viene caricato il browser non mostrer√† alcuna parentesi graffa, e poi vedremo il testo. (Il browser, prima di scaricare Angular, non ha idea di come interpretare un attributo ng-bind e nel dubbio lo ignora).</p>

<h3 id="ng-bind-html-un-nuovo-amico">ng-bind-html, un nuovo amico</h3>

<p>Ma torniamo alla domanda iniziale. Come facciamo a mostrare l‚Äôhtml all‚Äôinterno di una variabile <em>angularizzata</em>? La direttiva da chiamare stavolta √® <a href="https://docs.angularjs.org/api/ng/directive/ngBindHtml"><strong>ng-bind-html</strong></a>, che sfortunatamente non ha corrispettivi con un‚Äôaltra sintassi (niente doppie o triple parentesi qui). Il motivo per cui √® meno nota (e dovrebbe essere usata con cura!) √® che non bisognerebbe mai lasciare la responsabilit√† della formattazione del testo a un js, quindi non bisognerebbe inserire un <span class="lang:default decode:true  crayon-inline "><br /></span>¬† o qualsiasi altro tag in un messaggio. Inoltre sorgono dei problemi di sicurezza: che succede se un utente malevolo carica un tag <span class="lang:default decode:true  crayon-inline "><script>&lt;/span&gt;¬†?</script></span></p>

<p>Almeno per questo Angular ci mette in guardia, e infatti specifica chiaramente nella guida che per usare ng-bind-html bisogna iniettare <strong>$sanitize</strong> di angular, cos√¨ da eliminare eventuali tag scomodi. Senza l‚Äôimport di $sanitize non dovrebbe proprio funzionare, questo per farvi capire quanto √® importante ripulire codice che potrebbe essere compromesso.</p>

<p>Morale: usate <span class="lang:default decode:true  crayon-inline ">ng-bind-html</span>¬† con coscienza, ma utilizzatelo solo in pochi punti ben documentati dell‚Äôapplicazione, altrimenti in futuro potreste essere anche vittima di attacchi. Nel mio caso, l‚Äôho usato per una fix rapida su un messaggio di errore che arrivava dal server (ove risiedeva il famigerato <span class="lang:default decode:true  crayon-inline "><br /></span>¬†). Quando ci sono rilasci non si pu√≤ ragionare troppo üôÇ</p>
 
<ul class="share-buttons">
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/&t=" title="Share on Facebook" target="_blank" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/) + '&t=' + encodeURIComponent(document.title)); return false;"><img alt="Share on Facebook" src="/images/icons/Facebook.svg"></a></li>
  <li><a href="https://twitter.com/intent/tweet?source=https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/&text=Interpretare HTML in una stringa popolata da angular con ng-bind-html:%20https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/&via=micnasti" target="_blank" title="Tweet" onclick="window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(Interpretare HTML in una stringa popolata da angular con ng-bind-html) + ':%20'  + encodeURIComponent(https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/)); return false;"><img alt="Tweet" src="/images/icons/Twitter.svg"></a></li>
  <li><a href="https://plus.google.com/share?url=https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/" target="_blank" title="Share on Google+" onclick="window.open('https://plus.google.com/share?url=' + encodeURIComponent(https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/)); return false;"><img alt="Share on Google+" src="/images/icons/Google+.svg"></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/&title=Interpretare HTML in una stringa popolata da angular con ng-bind-html&summary=&source=https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/" target="_blank" title="Share on LinkedIn" onclick="window.open('http://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/) + '&title=' +  encodeURIComponent(document.title)); return false;"><img alt="Share on LinkedIn" src="/images/icons/LinkedIn.svg"></a></li>
</ul>

		</section>

		<section>
			 <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    
    var disqus_config = function () {
    	//var disqus_identifier = 'https://michelenasti.com';
			//var disqus_url = '';
			var disqus_url = 'https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/';
			var disqus_identifier = 'https://michelenasti.com/2015/05/interpretare-html-una-stringa-popolata-da-angular-con-ng-bind-html/';

    };
    
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//michele-nastis-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> 
		</section>

		<footer>
			<br> Altri articoli:
			<br>
			<div class="row">
				

				<article class="6u 12u(small) excerpt">
					<header>
						<h2><a href="/2015/05/basta-ai-powerpoint-fatti-male/">BASTA! ai powerpoint fatti male</a></h2>
					</header>
					<section>
						<p>Questo articolo l‚Äôho riadattato¬†nel 2009 su un vecchio articolo di Paolo Attivissimo; ogni tanto qualche amico mi dice che deve preparare delle slide e io continuo a ripetere questi suggerimenti. Magari¬†possono essere utili per chi deve ancora preparare le slide della tesi, o si sente insicuro. Seguite questi consigli: io l‚Äôho fatto e ancora oggi ricordano le mie presentazioni all‚Äôuniversit√†.</p>


					</section>
					<footer>
						<ul class="actions">
							<li><a href="/2015/05/basta-ai-powerpoint-fatti-male/" class="button">Read More</a></li>
						</ul>
					</footer>
				</article>
				 

				<article class="6u$ 12u(small) excerpt f-right">
					<header>
						<h2><a href="/2015/05/selenium-webdriver-for-dummies/">Selenium WebDriver for dummies</a></h2>
					</header>
					<section>
						<p>Esistono tool che permettono di scrivere i casi di test che simulano il comportamento dell‚Äôutente e di eseguirli all‚Äôinfinito, cosa utile per individuare eventuali regressioni durante lo sviluppo.</p>


					</section>
					<footer>
						<ul class="actions">
							<li><a href="//2015/05/selenium-webdriver-for-dummies/" class="button">Read More</a></li>
						</ul>
					</footer>
				</article>
				
			</div>
		</footer>

	</article>

</div>