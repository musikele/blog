<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<script>
		var host = "michelenasti.com";
		if ((host == window.location.host) && (window.location.protocol != "https:"))
			window.location.protocol = "https";
	</script>
	
	<title>Easy testing of NodeJS applications with Mocha - Michele Nasti's blog</title>
	 
	<meta name="keywords" content="Javascript, Nodejs, Testing, Mocha" />  
	<meta http-equiv="last-modified" content="2017-09-19 10:17:10 +0200" /> 
	<!--<noscript>-->
	<link rel="stylesheet" href="/css/skel.css" />
	<link rel="stylesheet" href="/css/style.css" />
	<link rel="stylesheet" href="/css/style-xlarge.css" />
	<link rel="stylesheet" href="/css/colorful.css" />
	<link rel="stylesheet" href="/css/social.css" />
	<link rel="stylesheet" href="/node_modules/animate.css/animate.min.css" />
	<meta name="google-site-verification" content="wpVjnRuXV99CAZxjYBzZgKbJm-8_tdLPrlP43u9zhV0" /> <!-- facebook Open Graph Metadatas -->
<meta content="your_facebook_app_id" property="fb:app_id">
<meta content="" property="og:site_name">


  <meta content="Easy testing of NodeJS applications with Mocha" property="og:title">



  <meta content="article" property="og:type">



  <meta content="I'm a full stack Developer with an eye for the web." property="og:description">



  <meta content="https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html" property="og:url">



  <meta content="2017-03-23T18:13:00+01:00" property="article:published_time">
  <meta content="https://www.facebook.com/micnasti/" property="article:author">



<meta content="/img/logo-high-resolution.png" property="og:image">



  
  <meta content="Javascript" property="article:tag">
  
  <meta content="Nodejs" property="article:tag">
  
  <meta content="Testing" property="article:tag">
  
  <meta content="Mocha" property="article:tag">
  


<!-- Twitter cards metadatas -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@vdaubry">
<meta name="twitter:creator" content="@micnasti">

  <meta name="twitter:title" content="Easy testing of NodeJS applications with Mocha">


  <meta name="twitter:url" content="https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html">



  <meta name="twitter:description" content="I'm a full stack Developer with an eye for the web.">



	<!--</noscript>-->
	<!--[if lte IE 8]><link rel="stylesheet" href="/css/ie/v8.css" /><![endif]-->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88764277-1', 'auto');
  ga('send', 'pageview');

</script>
	<link rel="stylesheet" href="/css/prism.css" />
</head>

<body id="top">

	<header id="header">
	<a href="#" class="image avatar"><img src="/images/michele_nasti.jpg" alt="michele nasti volto" /></a>
	<h1><strong><a href="/">Michele Nasti</a></strong><br /> Full-stack developer <br> with an eye for the web<br>
	</h1>
<a href="/chi-sono-michele-nasti/">Chi sono</a> | 
<a href="/talks-conferences/">Talks &amp; Conferences</a> | 
<a href="/archives/">Archives</a>

</header> <div id="main">
	<article>
		<header class="major">
			<h1 class="post-title"><a href="/2017/03/23/node-js-testing-easy-with-mocha.html">Easy testing of NodeJS applications with Mocha</a></h1>
			<p class="post-meta">Mar 23, 2017 • musikele</p>
		</header>

		<section>
			
<ul class="share-buttons">
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&t=" title="Share on Facebook" target="_blank" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html) + '&t=' + encodeURIComponent(document.title)); return false;"><img alt="Share on Facebook" src="/images/icons/Facebook.svg"></a></li>
  <li><a href="https://twitter.com/intent/tweet?source=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&text=Easy testing of NodeJS applications with Mocha:%20https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&via=micnasti" target="_blank" title="Tweet" onclick="window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(Easy testing of NodeJS applications with Mocha) + ':%20'  + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html)); return false;"><img alt="Tweet" src="/images/icons/Twitter.svg"></a></li>
  <li><a href="https://plus.google.com/share?url=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html" target="_blank" title="Share on Google+" onclick="window.open('https://plus.google.com/share?url=' + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html)); return false;"><img alt="Share on Google+" src="/images/icons/Google+.svg"></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&title=Easy testing of NodeJS applications with Mocha&summary=&source=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html" target="_blank" title="Share on LinkedIn" onclick="window.open('http://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html) + '&title=' +  encodeURIComponent(document.title)); return false;"><img alt="Share on LinkedIn" src="/images/icons/LinkedIn.svg"></a></li>
</ul>
			
			<p>Testing in Javascript has become an immensely popular argument, but still there’s a lot of people that has not clear how to do it effectively. <a href="/2016/08/my-very-personal-javascript-fatigue/">I was one of these</a>. There are many troubles that a young developer has to overcome in order to master Javascript testing. In this article, I’m going to explain Javascript testing with Mocha, a powerful library.</p>

<h2 id="why-testing-in-javascript">Why testing in Javascript</h2>

<p>An easy example. You write a function that takes only one argument, and use it extensively. After some days, you modify this function to take two arguments.</p>

<p>Obviously you try to find every place where this function is called and add the missing parameter. Since the scripting nature of the language, how can you tell that this modification did not break anything? How to discover rapidly what to fix? Are users our only testers?</p>

<h2 id="setup-the-example">Setup the example</h2>

<p>Let’s write a simple Node test file. Let’s call it <code>utils.js</code>, a file where we put all the functions that do not fit in a specific module.</p>

<pre><code>module.exports.add = (a,b) =&amp;gt;  a + b;
</code></pre>

<p>That’s it! Let’s test this function. Is our sum function really doing its job?</p>

<h2 id="setup-the-test">Setup the test</h2>

<p>First, let’s install 
<a href="https://mochajs.org"><strong>Mocha</strong></a>. This is easy as launching</p>

<pre><code>$ npm install --save-dev mocha 
</code></pre>

<p>Let’s modify our <code>package.json</code> (you did run <code>npm init</code>, didn’t you?) to add a new task:</p>

<pre><code>"scripts": {
    ... 
    "test": "mocha **/*.test.js"
  },
</code></pre>

<p>Mocha will be installed as a <em>development dependency</em>, this means that it is not necessary to run our code. Some deployment systems (like Heroku) will not download these dev dependencies.</p>

<p>As you can see, the <code>test</code> command will execute all files in every directory ending with <code>.test.js</code>. This is incredibly fast.</p>

<p>Let’s create in the very same directory where we put <code>utils.js</code>, another file called <code>utils.test.js</code>.</p>

<p>Here is the test code:</p>
<pre><code>const utils = require('./utils'); //(1)

it('should add two numbers', () =&amp;gt; {   //(2)
  let res = utils.add(33,11);
  if (res !== 44) {
     throw new Error(`Expected: 44, but got ${res}`); //(3)
  }
});
</code></pre>

<p>And now you can simply run <code>npm test</code>. you should see an out like this:</p>

<pre><code>$ npm test

&amp;gt; node-tests@1.0.0 test /Users/michelenasti/Doc
uments/node-tests
&amp;gt; mocha **/*.test.js



  ✓ should add two numbers

  1 passing (13ms)

</code></pre>

<h2 id="whats-going-on">What’s going on</h2>

<p>Our tests are run directly by Mocha, that’s why we don’t import the library in this function.</p>

<p>Mocha provides us a function called <code>it()</code>. You might notice this function at (1). It takes two parameters: a description of the test, and a function with the code to execute.</p>

<p>In the JS community tests are usually written in a <em>Behaviour Driven Development</em> paradygm, this is a complex notion, for now let’s just say that test description starts with “<em>should …</em>”. I’ll write more in the future :)</p>

<p>The second argument passed to <code>it()</code> is a function with the actual test code. Here we call the function under test, take the result and check the correctness.</p>

<p>How Mocha decides if a test has passed or not? If no errors are thrown in our test code, then the test is marked as passed. On the other side, if an <code>Error()</code> object is thrown, the test will stop and the message of the <code>Error</code> is printed to the terminal.</p>

<p><em>Exercise for you: modify <code>utils.js</code> to let the test fail :)</em></p>

<h2 id="do-js-developers-throw-errors-to-test-their-functions">Do JS developers throw errors to test their functions?</h2>

<p>No, in reality JS developers NEVER throw Errors. Usually in JS we use some other libraries to <em>assert</em> some properties on the result, using functions that are more expressive. We will talk about this aspect in another post. However, I think that seeing how tests work without assertion libraries is <em>fundamental</em> to use such libraries.</p>

<h2 id="last-but-not-least">Last but not least</h2>

<p>Do you want your test to run automatically everytime you change some file? Of course you can, mixing some code coming from a previous post (<a href="https://michelenasti.com/2017/01/31/develop-faster-in-nodejs-with-nodemon.html">nodemon</a>).</p>

<p>In <code>package.json</code> add the script <code>test-watch</code>…</p>

<pre><code class="language-javascript">"scripts": {
   "test": "mocha **/*.test.js",
   "test-watch": "nodemon --exec \"npm test\""
  },
</code></pre>

<p>Happy testing!</p>
 
			
			
<ul class="share-buttons">
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&t=" title="Share on Facebook" target="_blank" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html) + '&t=' + encodeURIComponent(document.title)); return false;"><img alt="Share on Facebook" src="/images/icons/Facebook.svg"></a></li>
  <li><a href="https://twitter.com/intent/tweet?source=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&text=Easy testing of NodeJS applications with Mocha:%20https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&via=micnasti" target="_blank" title="Tweet" onclick="window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(Easy testing of NodeJS applications with Mocha) + ':%20'  + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html)); return false;"><img alt="Tweet" src="/images/icons/Twitter.svg"></a></li>
  <li><a href="https://plus.google.com/share?url=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html" target="_blank" title="Share on Google+" onclick="window.open('https://plus.google.com/share?url=' + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html)); return false;"><img alt="Share on Google+" src="/images/icons/Google+.svg"></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html&title=Easy testing of NodeJS applications with Mocha&summary=&source=https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html" target="_blank" title="Share on LinkedIn" onclick="window.open('http://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html) + '&title=' +  encodeURIComponent(document.title)); return false;"><img alt="Share on LinkedIn" src="/images/icons/LinkedIn.svg"></a></li>
</ul>

			<h4>Related Posts:</h4>
<div class="articles-row">







    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    
        <div class="col-4">
        <h5><a href="/2017/03/14/two-easy-ways-perform-get-requests-in-nodejs.html">Two easy ways perform GET requests in NodeJS  <span class="label label-default">Javascript</span>  <span class="label label-default">Nodejs</span> </a></h5>
        </div>
        
         
    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    



    
    

    

    





    
        
        
        
        
        

        <div class="col-4">
            <h5><a href="/2016/12/12/perche-un-programmatore-dovrebbe-avere-un-blog.html">Perché un programmatore dovrebbe avere un blog</a></h5>
        </div>
    
        
        
        
        
        

        <div class="col-4">
            <h5><a href="/2015/06/imovie-50-error/">iMovie and the -50 error</a></h5>
        </div>
    
        
        
        
        
        

        <div class="col-4">
            <h5><a href="/2017/09/19/come-capire-il-bitcoin-le-funzioni-crittografiche.html">Come capire il bitcoin: le funzioni crittografiche</a></h5>
        </div>
    


</div>

		</section>

		<section>
			 <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    
    var disqus_config = function () {
    	//var disqus_identifier = 'https://michelenasti.com';
			//var disqus_url = '';
			var disqus_url = 'https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html';
			var disqus_identifier = 'https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html';

    };
    
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//michele-nastis-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> 
		</section>

		<footer>			
			<div>
    

    <div class="6u 12u(small) excerpt" id="previousArticle">
        <header>
            <h2><a href="/2017/03/20/l-inglese-tra-italiani-a-lavoro-e-una-scelta-sbagliata.html">L'Inglese tra italiani, a lavoro, è una scelta sbagliata</a></h2>
        </header>
        <section>
            <p>C’è un trend che ogni tanto ritorna, ossia quello di usare l’inglese come lingua ufficiale durante l’orario di lavoro. Con colleghi italiani. In un ufficio italiano.</p>


        </section>
        <div>
            <ul class="actions">
                <li><a href="/2017/03/20/l-inglese-tra-italiani-a-lavoro-e-una-scelta-sbagliata.html" class="button">Read More</a></li>
            </ul>
        </div>
    </div>
     

    <div class="6u$ 12u(small) excerpt f-right" id="nextArticle">
        <header>
            <h2><a href="/2017/03/27/become-a-test-expert-in-nodejs-with-these-tricks.html">Become a test expert in NodeJS with these tricks</a></h2>
        </header>
        <section>
            <p>After reading my first guide to 
<a href="https://michelenasti.com/2017/03/23/node-js-testing-easy-with-mocha.html">testing NodeJS with Mocha</a> you might have grasped the fundamental concepts of NodeJS testing. However, <strong>real word code is usually tested with some other expedients</strong> that you might know to be a better tester (and coder).</p>


        </section>
        <div>
            <ul class="actions">
                <li><a href="//2017/03/27/become-a-test-expert-in-nodejs-with-these-tricks.html" class="button">Read More</a></li>
            </ul>
        </div>
    </div>
    
</div>
		</footer>

	</article>

</div>
<script src="/js/infinite-scroll.js"></script>

	<!-- Footer -->
	<footer id="footer">
	<ul class="icons">

		
		<li>
			<a href="https://github.com/musikele" class="icon fa-github">
				<span class="label">GitHub</span>
			</a>
		</li>
		 
		<li>
			<a href="https://twitter.com/micnasti" class="icon fa-twitter">
				<span class="label">Twitter</span>
			</a>
		</li>
		 
		<li>
			<a href="https://linkedin.com/in/michelenasti" class="icon fa-linkedin">
				<span class="label">LinkedIn</span>
			</a>
		</li>
		 
		<li>
			<a href="https://plus.google.com/+MicheleNasti" class="icon fa-google-plus">
				<span class="label">Google+</span>
			</a>
		</li>
		 
		<li>
			<a href="https://www.facebook.com/musikele" class="icon fa-facebook">
				<span class="label">Facebook</span>
			</a>
		</li>
		  
	</ul>
	<ul class="copyright">
		<li>&copy; Michele Nasti</li>
		<li>Based on <a href="http://html5up.net/strata">STRATA</a> theme</li>
	</ul>
</footer>
	<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/jquery.poptrox.min.js"></script>
	<script src="/js/skel.min.js"></script>
	<script src="/js/init.js"></script>
	<script src="/js/prism.js"></script>
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#000"
    },
    "button": {
      "background": "#f1d600"
    }
  },
  "position": "bottom-left",
  "content": {
    "href": "//www.iubenda.com/privacy-policy/84379975"
  }
})});
</script>
	<!-- <script src="/js/badge.js"></script> -->
</body>

</html>
